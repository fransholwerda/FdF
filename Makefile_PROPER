# **************************************************************************** #
#                                                                              #
#                                                         ::::::::             #
#    Makefile_PROPER                                    :+:    :+:             #
#                                                      +:+                     #
#    By: fholwerd <fholwerd@student.codam.nl>         +#+                      #
#                                                    +#+                       #
#    Created: 2021/09/28 17:20:12 by fholwerd      #+#    #+#                  #
#    Updated: 2022/03/01 12:52:22 by fholwerd      ########   odam.nl          #
#                                                                              #
# **************************************************************************** #

# NAME	= fdf
# SRCS	= main.c
# B_SRCS = 
# OBJS	= $(SRCS:.c=.o)
# B_OBJS = $(SRCS:.c=.o)
# INCS	= -Imlx/ -Ilibft/
# FRWRKS	= -framework OpenGL -framework AppKit
# LIBS_P  = libmlx.dylib

# all: $(NAME)

# $(NAME): $(OBJS)
# 	$(CC) -Lmlx -lmlx $(FRWRKS) -o $(NAME) $(LIBS_P)

# %.o: %.c
# 	$(CC) -Wall -Wextra -Werror -Imlx -c $< -o $@

# bonus:
# 	$(MAKE) WITH_BONUS=1 all

# clean:
# 	rm -f $(OBJS)

# fclean: clean
# 	rm -f $(NAME)

# re: fclean all

# .PHONY: all clean fclean re




ROOT = $(dir $(abspath $(lastword $(MAKEFILE_LIST))))
NAME    = fdf
SRC_GNL = gnl/get_next_line.c gnl/get_next_line_utils.c
SRC_FDF = srcs/main.c \
		srcs/draw.c \
		struct_point_utility.c \
		struct_row_utility.c \
		parse.c coordinates.c
SRCS	= $(SRC_GNL) $(SRC_FDF)
B_SRCS  = bonus_bonus.c
OBJS    = $(SRCS:.c=.o)
B_OBJS  = $(B_SRCS:.c=.o)
CC      = cc
INCS    = -Iincludes/ -Ilibft/ -Imlx/
FLAGS   = -O3 -g3
FRWRKS  = -framework OpenGL -framework AppKit
LIBS_P  = ${ROOT}/libmlx.dylib ${ROOT}/libft/libft.a

ifdef BONUS
FLAGS   += -D BONUS
RELEVANT_OBJS = $(OBJS) $(B_OBJS)
else
RELEVANT_OBJS = $(OBJS)
endif

%.o: $(ROOT)%.c
	${CC} ${FLAGS} -c $(CPPFLAGS) -o $@ $< ${INCS}
$(NAME): ${RELEVANT_OBJS}
	make libs -C ${ROOT}
	gcc $(RELEVANT_OBJS) ${FLAGS} ${FRWRKS} -o $(NAME) ${LIBS_P}
all: $(NAME)
libs:
	make -C ${ROOT}/mlx
	cp ${ROOT}/mlx/libmlx.dylib ./libmlx.dylib
clean:
	rm -rf $(OBJS) $(B_OBJS)
	make clean -C ${ROOT}/mlx
fclean: clean
	$(RM) $(NAME)
	rm -rf **.dylib
	make fclean -C
re: fclean all
bonus:
	${MAKE} BONUS=1 all
.PHONY: all clean fclean re .c.o libs